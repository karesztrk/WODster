@(currentPage: dao.AbstractDAO.Page[model.journal.PersonalRecord], currentSortBy: String, currentOrder: String, currentFilter: String)

@import helper._
@authenticated = @{util.permission.Identity.isAuthenticated()}

@****************************************
* Helper generating navigation links    *
****************************************@
@link(newPage:Int, newSortBy:String) = @{
    
    var sortBy = currentSortBy
    var order = currentOrder
    
    if(newSortBy != null) {
        sortBy = newSortBy
        if(currentSortBy == newSortBy) {
            if(currentOrder == "asc") {
                order = "desc"
            } else {
                order = "asc"
            }
        } else {
            order = "asc"
        }
    }
    
    // Generate the link
    routes.PersonalRecordController.list(newPage, sortBy, order, currentFilter)
    
}

@**********************************
* Helper generating table headers *
***********************************@
@header(key:String, title:String) = {
    <th class="@key.replace(".","_") header @if(currentSortBy == key) @{if(currentOrder == "asc") "headerSortDown" else "headerSortUp"}">
        <a href="@link(0, key)">@title</a>
    </th>
}

@main("journal") {
    
    <h1>Personal Records</h1>
    
	@if(authenticated) {
		<a href="@routes.PersonalRecordController.create()"> <button class="btn btn-primary">New <span class="glyphicon glyphicon-plus"></span></button></a>
	}
    
    <table class="table table-hover">
	    <thead>
	        <tr>
	            @header("name", "Name")
	            @header("date", "Date")
	            @header("description", "Result")
	            @header("actions", "")
	        </tr>
	    </thead>
	    <tbody>
	
	        @for(record <- currentPage.getList) {
	            <tr>
	                <td><a href="#">@record.workout.title</a></td>
	                <td>@record.date.format("dd MMM yyyy")</td>
	                <td>@record.result</td>
	                <td class="text-right">
	                	@form(routes.PersonalRecordController.delete(record.id)) {
	                		<button class="btn btn-link btn-sm" type="submit"><i class="glyphicon glyphicon-remove"></i></button>
	                	} 
	                </td>
	            </tr>
	        }
	
	    </tbody>
	</table>
	
	<div id="pagination" class="pager">
	    <ul>
	        @if(currentPage.hasPrev) {
	            <li>
	                <a href="@link(currentPage.getPageIndex - 1, null)">Previous</a>
	            </li>
	        } else {
	            <li class="disabled">
	                <a>Previous</a>
	            </li>
	        }
	       
	        @if(currentPage.hasNext) {
	            <li>
	                <a href="@link(currentPage.getPageIndex + 1, null)">Next</a>
	            </li>
	        } else {
	            <li>
	                <a>Next</a>
	            </li>
	        }
	    </ul>
	</div>
}

            